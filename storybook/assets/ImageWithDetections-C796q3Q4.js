import{j as i}from"./jsx-runtime-u17CrQMm.js";import{R as v}from"./iframe-Bm-1nfva.js";const C="_container_wit56_1",N="_imageWrapper_wit56_9",W="_image_wit56_9",L="_boundingBox_wit56_37",f={container:C,imageWrapper:N,image:W,boundingBox:L};function P(e,g=2){if(e.length<3)return e.map(([r,u])=>`${r},${u}`).join(" ");const s=[],c=e.length;for(let r=0;r<c;r++){const u=e[(r-1+c)%c],t=e[r],y=e[(r+1)%c],p=t[0]-u[0],m=t[1]-u[1],o=y[0]-t[0],n=y[1]-t[1],l=Math.sqrt(p*p+m*m),h=Math.sqrt(o*o+n*n);if(l===0||h===0){s.push(`${r===0?"M":"L"} ${t[0]},${t[1]}`);continue}const a=p/l,$=m/l,k=o/h,b=n/h,w=a*k+$*b,M=Math.acos(Math.max(-1,Math.min(1,w))),d=Math.min(g,l*.5,h*.5);if(M<Math.PI-.1){const x=t[0]-a*d,R=t[1]-$*d,I=t[0]+k*d,j=t[1]+b*d;r===0?s.push(`M ${x},${R}`):s.push(`L ${x},${R}`),s.push(`Q ${t[0]},${t[1]} ${I},${j}`)}else r===0?s.push(`M ${t[0]},${t[1]}`):s.push(`L ${t[0]},${t[1]}`)}return s.push("Z"),s.join(" ")}function D(e){if(e.polygon&&e.polygon.length>=3){const g=e.polygon.map(c=>c[0]),s=e.polygon.map(c=>c[1]);return{topLeftX:Math.min(...g),topLeftY:Math.min(...s),bottomY:Math.max(...s),centerX:e.x,centerY:e.y}}else return{topLeftX:e.x-e.width/2,topLeftY:e.y-e.height/2,bottomY:e.y+e.height/2,centerX:e.x,centerY:e.y}}function E({imageUrl:e,detectedCookies:g,onCookieClick:s,className:c,borderColor:r="transparent",renderTopLeft:u,renderBottom:t,renderCenter:y}){const[p,m]=v.useState(null);return v.useEffect(()=>{console.log("[ImageWithDetections] Rendering with:",{imageUrl:e,cookieCount:g.length,cookiesWithPolygons:g.filter(o=>o.polygon&&o.polygon.length>=3).length,hoveredIndex:p})},[e,g,p]),v.useEffect(()=>{p!==null&&console.log("[ImageWithDetections] Hover state changed - now hovering over cookie:",p)},[p]),i.jsx("div",{className:`${f.container} ${c||""}`,children:i.jsxs("div",{className:f.imageWrapper,children:[i.jsx("img",{src:e,alt:"Cookie detection",className:f.image,style:{pointerEvents:"none"}}),g.map((o,n)=>{const l=D(o),h=o.polygon&&o.polygon.length>=3;return!h&&o.polygon&&console.warn(`[ImageWithDetections] Cookie ${n} has invalid polygon:`,{polygonLength:o.polygon.length,polygon:o.polygon}),i.jsxs(v.Fragment,{children:[h?i.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:15},children:[i.jsx("path",{className:f.cookieOverlay,d:P(o.polygon,5),fill:p===n?"rgba(33, 150, 243, 0.3)":"rgba(33, 150, 243, 0)",stroke:r,strokeWidth:"0.5",strokeLinejoin:"round",strokeLinecap:"round",style:{cursor:s?"pointer":"default",pointerEvents:"all",transition:"fill 0.2s ease"},onMouseEnter:()=>{console.log(`[ImageWithDetections] Mouse enter cookie ${n}`),m(n)},onMouseLeave:()=>{console.log(`[ImageWithDetections] Mouse leave cookie ${n}`),m(null)},onClick:a=>{a.stopPropagation(),s?.(o,n,a)}}),i.jsx("title",{children:`Cookie ${n+1}: ${(o.confidence*100).toFixed(1)}% confidence`})]},`detected-polygon-${n}`):i.jsx("div",{className:`${f.boundingBox} ${f.cookieOverlay}`,style:{left:`${o.x-o.width/2}%`,top:`${o.y-o.height/2}%`,width:`${o.width}%`,height:`${o.height}%`,backgroundColor:p===n?"rgba(33, 150, 243, 0.3)":"rgba(33, 150, 243, 0)",borderColor:r,cursor:s?"pointer":"default",transition:"background-color 0.2s ease",pointerEvents:"all",zIndex:15},onMouseEnter:a=>{console.log(`[ImageWithDetections] Mouse enter bounding box ${n}`,a),a.stopPropagation(),m(n)},onMouseLeave:a=>{console.log(`[ImageWithDetections] Mouse leave bounding box ${n}`,a),a.stopPropagation(),m(null)},title:`Cookie ${n+1}: ${(o.confidence*100).toFixed(1)}% confidence`,onClick:a=>{console.log(`[ImageWithDetections] Bounding box ${n} clicked`),a.stopPropagation(),s?.(o,n,a)}},`detected-${n}`),(()=>{const a={detected:o,index:n,bounds:l};return i.jsxs(i.Fragment,{children:[u&&i.jsx("div",{style:{position:"absolute",left:`${Math.max(0,l.topLeftX)}%`,top:`${Math.max(0,l.topLeftY)}%`,zIndex:20,pointerEvents:"none"},children:u(a)},`top-left-${n}`),y&&i.jsx("div",{style:{position:"absolute",left:`${l.centerX}%`,top:`${l.centerY}%`,zIndex:19,pointerEvents:"none",transform:"translate(-50%, -50%)"},children:y(a)},`center-${n}`),t&&i.jsx("div",{style:{position:"absolute",left:`${l.centerX}%`,top:`${Math.min(100,l.bottomY+1)}%`,zIndex:20,pointerEvents:"none",transform:"translate(-50%, 0)"},children:t(a)},`bottom-${n}`)]})})()]},`cookie-${n}`)})]})})}E.__docgenInfo={description:`Reusable component for rendering images with cookie detection overlays.

This component displays an image with visual overlays for detected cookies.
It supports both polygon-based detection shapes and bounding boxes as fallback.
The component provides interactive features like hover effects and click handlers,
and allows for custom rendering of overlays at different positions.

@example
\`\`\`tsx
<ImageWithDetections
  imageUrl="/path/to/image.jpg"
  detectedCookies={[
    { x: 50, y: 50, width: 10, height: 10, confidence: 0.95, polygon: [[45,45], [55,45], [55,55], [45,55]] }
  ]}
  onCookieClick={(cookie, index) => console.log('Clicked cookie', index)}
/>
\`\`\`

@param props - Component props
@param props.imageUrl - URL of the image to display
@param props.detectedCookies - Array of detected cookie objects with position and shape data
@param props.onCookieClick - Optional callback when a cookie overlay is clicked
@param props.className - Optional CSS class name for the container
@param props.borderColor - Border color for cookie overlays (default: transparent)
@param props.renderTopLeft - Optional render function for top-left overlay content
@param props.renderBottom - Optional render function for bottom overlay content
@param props.renderCenter - Optional render function for center overlay content (e.g., animations)

@returns JSX element containing the image with detection overlays`,methods:[],displayName:"ImageWithDetections",props:{imageUrl:{required:!0,tsType:{name:"string"},description:""},detectedCookies:{required:!0,tsType:{name:"Array",elements:[{name:"DetectedCookie"}],raw:"DetectedCookie[]"},description:""},onCookieClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(cookie: DetectedCookie, index: number, event: React.MouseEvent) => void",signature:{arguments:[{type:{name:"DetectedCookie"},name:"cookie"},{type:{name:"number"},name:"index"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"event"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""},borderColor:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'transparent'",computed:!1}},renderTopLeft:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: OverlayRenderProps) => React.ReactNode",signature:{arguments:[{type:{name:"OverlayRenderProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},renderBottom:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: OverlayRenderProps) => React.ReactNode",signature:{arguments:[{type:{name:"OverlayRenderProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},renderCenter:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: OverlayRenderProps) => React.ReactNode",signature:{arguments:[{type:{name:"OverlayRenderProps"},name:"props"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};export{E as I,D as c};
