import{j as t}from"./jsx-runtime-u17CrQMm.js";import{r}from"./iframe-Bm-1nfva.js";import{g as E,b as l,o as N,s as A,G as j,c as I,d as B}from"./firebase-DgwybkJe.js";import{A as S}from"./AlertModal-qe62fxxT.js";import{u as U}from"./chunk-JMJ3UQ3L-DVVcMVDb.js";const C="_signInButton_1fo0a_1",M="_avatarButton_1fo0a_24",k="_avatar_1fo0a_24",R="_avatarPlaceholder_1fo0a_46",P="_userMenu_1fo0a_60",F="_dropdown_1fo0a_66",O="_userInfo_1fo0a_79",G="_userName_1fo0a_84",T="_userEmail_1fo0a_91",z="_signOutButton_1fo0a_97",L="_loading_1fo0a_113",o={signInButton:C,avatarButton:M,avatar:k,avatarPlaceholder:R,userMenu:P,dropdown:F,userInfo:O,userName:G,userEmail:T,signOutButton:z,loading:L};function D(){const m=U(),[s,f]=r.useState(null),[v,_]=r.useState(!0),[c,d]=r.useState(!1),g=r.useRef(null),[h,p]=r.useState(null),[y,b]=r.useState("error");r.useEffect(()=>{let e=!0;const n=async()=>{try{const a=await E(l);a&&e?console.log("User signed in via redirect:",a.user.email):console.log("No redirect result found")}catch(a){a?.code!=="auth/no-auth-event"&&e&&console.error("Error getting redirect result:",a)}const u=l.currentUser;return console.log("Current auth user:",u?u.isAnonymous?"anonymous (test user)":u.email:"none"),N(l,async a=>{e&&(console.log("Auth state changed:",a?`${a.email||"user"} (${a.uid})`:"signed out"),f(a),_(!1))})};let i;return n().then(u=>{i=u}),()=>{e=!1,i&&i()}},[]),r.useEffect(()=>{const e=n=>{g.current&&!g.current.contains(n.target)&&d(!1)};if(c)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[c]);const x=async()=>{try{const e=new j;e.addScope("profile"),e.addScope("email"),console.log("Starting Google sign-in...");try{console.log("Attempting popup sign-in...");const n=await I(l,e);console.log("âœ… Google sign-in successful"),console.log("ðŸ“‹ Your User UID:",n.user.uid),console.log("ðŸ“§ Your Email:",n.user.email),console.log("ðŸ’¡ Tip: Enable test user mode to use a separate test database"),console.log("ðŸ”§ To create events, add your UID to: Firebase Console â†’ Firestore â†’ system/admins â†’ userIds array")}catch(n){const i=n;if(i?.code==="auth/popup-blocked"||i?.code==="auth/popup-closed-by-user"||i?.code==="auth/cancelled-popup-request"){console.log("Popup blocked/failed, using redirect flow"),await B(l,e);return}throw n}}catch(e){console.error("Error signing in:",e);const n=e;n?.code!=="auth/redirect-cancelled-by-user"&&(p(`Failed to sign in: ${n?.message||"Please try again."}`),b("error"))}},w=async()=>{try{await A(l),d(!1),m("/",{replace:!0})}catch(e){console.error("Error signing out:",e)}};return v?t.jsx("div",{className:o.loading,children:"..."}):s&&s.email?t.jsxs("div",{className:o.userMenu,ref:g,children:[t.jsx("button",{onClick:()=>d(!c),className:o.avatarButton,title:`Signed in as ${s.displayName||s.email}`,children:s.photoURL?t.jsx("img",{src:s.photoURL,alt:s.displayName||"User avatar",className:o.avatar}):t.jsx("div",{className:o.avatarPlaceholder,children:s.displayName?.[0]?.toUpperCase()||s.email?.[0]?.toUpperCase()||"U"})}),c&&t.jsxs("div",{className:o.dropdown,children:[t.jsxs("div",{className:o.userInfo,children:[t.jsx("div",{className:o.userName,children:s.displayName||"User"}),t.jsx("div",{className:o.userEmail,children:s.email})]}),t.jsx("button",{onClick:w,className:o.signOutButton,children:"Sign out"})]})]}):t.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsxs("button",{onClick:e=>{e.preventDefault(),console.log("Sign in button clicked"),x()},className:o.signInButton,children:[t.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",style:{marginRight:"8px"},children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in with Google"]}),h&&t.jsx(S,{message:h,type:y,onClose:()=>p(null)})]})}D.__docgenInfo={description:`AuthButton - Authentication button component with user menu.

This component handles user authentication and displays either a sign-in button
or a user menu with avatar and sign-out option. It integrates with Firebase Auth
and supports both popup and redirect authentication flows.

Features:
- Google Sign-In integration
- Automatic redirect result handling
- User avatar display (photo or initial)
- Dropdown menu with user info and sign-out
- Error handling with alert modals
- Automatic navigation after sign-out

The component automatically detects authentication state changes and updates
the UI accordingly. It handles both popup and redirect authentication methods,
falling back to redirect if popup is blocked.

@example
\`\`\`tsx
<AuthButton />
\`\`\`

@returns JSX element containing either sign-in button or user menu`,methods:[],displayName:"AuthButton"};export{D as A};
